<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="referrer" content="origin">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convert annual salary into hourly rate</title>
    <!--[if lt IE 9]>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script>
    <![endif]-->
    <script src="assets/jquery.min.js"></script>
    <script src="assets/rangeslider.min.js"></script>
    <script src="assets/calculator.js"></script>
    <link rel="stylesheet" type="text/css" href="assets/calculator.css"/>
  </head>
  <body>
    <div class="row">
      <input type="range" min="50000" max="250000" step="5000" value="150000" id="annualInput" data-rangeslider>
      <div class="calculator">
        <h1>
          <div class="annual">
            <label>Annual Salary</label>
            <output id="annualOutput"></output>
          </div>
          <div class="equivalency">=</div>
          <div class="hourly">
            <label>Hourly Rate</label>
            <output id="hourlyOutput"></output>
          </div>
        </h1>
        <h2>Assumptions</h2>
        <div class="column">
          <div class="variablesRow">
            <!-- Adjust size/color of font to indicate norm (green = norm, reddish = outside range, dark red = very far outside range) -->
            <label for="workDays">Work Days per Year: </label>
            <button type="button" id="workDaysDecrement"><img src="assets/minus.png" /></button>
            <output id="workDaysOutput" type="number" value="261"></output>
            <button type="button" id="workDaysIncrement"><img src="assets/add.png" /></button>
          </div>
        </div>
      </div>
    </div>
    <script>
      $(function() {
        $annualOutput = $('output#annualOutput')[0];
        $startingAnnual = 150000;
        $hourlyOutput = $('output#hourlyOutput')[0];
        $startingHourly = 100;
        // Assumptions for incrementing
        $workDaysOutput = $('output#workDaysOutput')[0];
        $startingWorkDays = 261;

        // For ie8 support
        var textContent = ('textContent' in document) ? 'textContent' : 'innerText';

        // Helpers
        function valueOutput(element, currency = null) {
          var value = element.value;
          var output = element.parentNode.getElementsByTagName('output')[0] || element.parentNode.parentNode.getElementsByTagName('output')[0];
          var prepend = currency ? '$' : ''
          output[textContent] = prepend + Number(value).toLocaleString();
        }

        // Update the increment/decrement, then adjust the hourly total
        $("#workDaysIncrement").on('click', function (e) {
          // Update element value
          adjustHourly();
        });

        function adjustHourly() {
          // Recalculate new hourly total

          // Assign it to the element
          $hourlyOutput.value = 150;

          // Update the DOM
          valueOutput($hourlyOutput, currency = true);
        }

        $(document).on('input', 'input[type="range"]#annualInput, [data-rangeslider]', function(e) {
          valueOutput(e.target, currency = true);
        });

        // On any assumption's adjustment, recalculate hourly

        // Initialize range slider
        $('input[type="range"]#annualInput').rangeslider({
          polyfill: false,
          onInit: function() {
            $annualOutput.value = $startingAnnual;
            valueOutput($annualOutput, currency = true);
            $hourlyOutput.value = $startingHourly;
            valueOutput($hourlyOutput, currency = true);
            $workDaysOutput.value = $startingWorkDays;
            valueOutput($workDaysOutput);
          },

          onSlide: function(position, value) {
              // TODO: recalculate hourly based on assumptions
              // console.log('onSlide');
              // console.log('position: ' + position, 'value: ' + value);
          },

        });
      });
    </script>
  </body>
</html>
